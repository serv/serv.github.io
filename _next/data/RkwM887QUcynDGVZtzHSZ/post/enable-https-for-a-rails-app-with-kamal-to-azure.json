{"pageProps":{"post":{"title":"Enable HTTPS for a Rails app with Kamal to Azure","createdAt":"2024-12-03T23:13:30-08:00","categories":["rails","kamal"],"slug":"enable-https-for-a-rails-app-with-kamal-to-azure","fullPath":"/Users/jasonkim/projects/websites/serv.github.io/_posts/2024-12-03-enable-https-for-a-rails-app-with-kamal.md","content":"<p>Refer to previous two posts to deploy a Rails app to Azure.</p>\n<ul>\n<li><a href=\"https://blog.jasonkim.ca/post/deploy-rails-721-sqlite3-app-to-azure-using-kamal\">Deploy Rails 7.2.1 + Sqlite3 App to Azure Using Kamal</a></li>\n<li><a href=\"https://blog.jasonkim.ca/post/deploy-rails-721-managed-postgresql-app-to-azure-using-kamal-211\">Deploy Rails 7.2.1 + Managed Postgresql App to Azure Using Kamal 2.1.1</a></li>\n</ul>\n<p>This post is made for:</p>\n<ul>\n<li>Ruby: 3.3.5</li>\n<li>Rails: 8.0.0</li>\n<li>Kamal: 2.3.0 </li>\n</ul>\n<h1>1. Load Balancer Setup</h1>\n<ol>\n<li>Sign into Azure</li>\n<li>Search for Load Balancers and select it.</li>\n<li>Select the load balancer for the VM running the Rails app.</li>\n<li>Select Settings > Inbound NAT rules link in the left sidebar.</li>\n<li>Click +Add</li>\n<li>Create a new NAT inbound rule like below<ul>\n<li><img src=\"/images/2024/12/3/lb-nat-inbound.png\"></li>\n</ul></li>\n</ol>\n<h1>2. Rails App</h1>\n<p>Setup the Rails like like the following.</p>\n<h2>2.1 <code>config/environments/production.rb</code></h2>\n<pre><code class=\"language-ruby\">config.force_ssl = true\n</code></pre>\n<h2>2.2 <code>config/deploy.yml</code></h2>\n<pre><code class=\"language-yaml\">...\nproxy:\n  ssl: true\n  host: yourdomain.com\n...\n</code></pre>\n<h2>2.3 Deploy and Check</h2>\n<ol>\n<li>Run <code>kamal deploy</code></li>\n<li>Check <code>yourdomain.com</code></li>\n</ol>\n"}},"__N_SSG":true}