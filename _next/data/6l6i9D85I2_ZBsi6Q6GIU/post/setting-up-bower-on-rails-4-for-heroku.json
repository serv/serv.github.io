{"pageProps":{"post":{"title":"Setting up Bower on Rails 4 for Heroku","createdAt":"2015-06-29T00:00:00-07:00","categories":["rails"],"slug":"setting-up-bower-on-rails-4-for-heroku","fullPath":"/home/jason/projects/websites/serv.github.io/_posts/2015-06-29-setting-up-bower-on-rails-4-for-heroku.md","content":"<p>We know Bower is great for managing frontend packages such as jQuery and Bootstrap.\nI noticed that it's not obvious how I can use Bower with Rails and Heroku.\nHere is how I set up Bower to work with Rails 4 app running on Heroku.</p>\n<p>My local system setup looks like this.</p>\n<ul>\n<li>OS X Yosemite V 10.10.3</li>\n<li>ruby 2.2.1p85 (2015-02-26 revision 49769) [x86_64-darwin14]</li>\n<li>Rails 4.2.3</li>\n<li>Bower 1.4.1</li>\n<li>Node v0.10.38</li>\n</ul>\n<h2>1. Prerequisites</h2>\n<p>I'm gonna assume that you have some basics down already.</p>\n<ul>\n<li>Install Ruby and Ruby on Rails.</li>\n<li>Install Node and have npm working.</li>\n<li>Install Bower</li>\n</ul>\n<h2>2. Configure npm package and bower package</h2>\n<p>Run <code>npm init</code> to create <code>package.json</code> file with correct npm\nconfiguration for your app.</p>\n<p>Now run <code>npm install bower --save</code>. This will include bower as a\ndependency for your npm package.json.</p>\n<p>Whenever you install a npm package, add <code>--save</code> to automatically\nadd the package as the dependency.</p>\n<p>Run <code>bower init</code> to create <code>bower.json</code> file with correct bower\nconfiguration for your app.</p>\n<p>Now install your packages running <code>npm install [pakcage-name] --save</code>.</p>\n<p>Again, whenever you install a bower package, add <code>--save</code> to automatically\nadd the bower package as the dependency.</p>\n<h2>3. Make Bower work with Rails</h2>\n<p>Let's specify where bower packages are installed on the Rails app.</p>\n<p>Create a file called <code>.bowerrc</code>, and add</p>\n<p>{% highlight json %}\n{\n\"directory\": \"vendor/assets/bower_components\"\n}\n{% endhighlight %}</p>\n<p><code>vendor/assets/bower_components</code> is where bower packages will be installed.</p>\n<p>At this point, let's edit <code>.gitignore</code>, so we don't commit npm packages or bower packages.\nAt the end of <code>.gitignore</code> file, add</p>\n<p>{% highlight text %}\nnode_modules\nvendor/assets/bower_components\n{% endhighlight %}</p>\n<p>In <code>config/application.rb</code>, add:</p>\n<p>{% highlight ruby %}\nconfig.assets.paths &#x3C;&#x3C; Rails.root.join('vendor', 'assets', 'bower_components')\n{% endhighlight %}</p>\n<p>This will ensure that Rails picks up asset files from where bower packages are\ninstalled.</p>\n<p>If you wanna start using Bootstrap for example, in the <code>app/assets/stylesheets/application.css</code>,\nyou can add:</p>\n<p>{% highlight js %}\n*= require bootstrap/dist/css/bootstrap\n{% endhighlight %}</p>\n<p>And in <code>app/assets/javascript/application.js</code>,</p>\n<p>{% highlight js %}\n//= require bootstrap/dist/js/bootstrap\n{% endhighlight %}</p>\n<p>Make sure restart the Rails app to see the bower packages working with Rails.</p>\n<h2>4. Use Bower on Heroku</h2>\n<p>At this point, Bower should be working well with Rails on your local environment.\nHowever, when you try to use it on Heroku, it'll error out while it\nis trying to precompile assets.</p>\n<p>This part, I am following some steps taken in <a href=\"https://coderwall.com/p/6bmygq/heroku-rails-bower\">Anthony Smith's post</a>.</p>\n<p>Configure Heroku to use ddollar's multi-buildpack:</p>\n<p><code>heroku config:add BUILDPACK_URL=https://github.com/ddollar/heroku-buildpack-multi.git</code></p>\n<p>Create a file called: <code>.buildpacks</code> and add:</p>\n<p>{% highlight text %}\n<a href=\"https://github.com/heroku/heroku-buildpack-nodejs\">https://github.com/heroku/heroku-buildpack-nodejs</a>\n<a href=\"https://github.com/heroku/heroku-buildpack-ruby\">https://github.com/heroku/heroku-buildpack-ruby</a>\n{% endhighlight %}</p>\n<p>Make sure that the ruby buildpack is the last one in the list.\nThis will allow you to access the Rails console when running heroku run console.</p>\n<p>In the <code>package.json</code>, add a postinstall script. It should look like this.</p>\n<p>{% highlight json %}\n{\n...</p>\n<p>\"scripts\": {\n\"postinstall\": \"./node_modules/bower/bin/bower install\"\n}</p>\n<p>...\n}\n{% endhighlight %}</p>\n<p>Now push to Heroku!</p>\n<p><code>git push heroku master</code></p>\n<p><code>npm install</code> will take a while to finish.</p>\n"}},"__N_SSG":true}